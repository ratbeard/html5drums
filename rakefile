require 'rush'

source = Rush.launch_dir['source.html']
out = Rush.launch_dir['index.html']
sounds = Rush.launch_dir['drumkit/*.wav']

task :default => :compile
  
desc "Copy in sounds file paths as <audio> tags"
task :compile => [:copy_source, :insert_audio_tags ]

desc "make a copy of our page template"
task :copy_source do
  source.duplicate 'index.html'
end

desc "insert audo tags into template copy"
task :insert_audio_tags do
  tags = sounds.map {|s| 
    "<audio id='#{s.name}' title='#{s.name}' src='#{s}' autobuffer />"
  }
  out.replace_contents!('<!-- audio goes here -->', tags.join("\n"))
end



  